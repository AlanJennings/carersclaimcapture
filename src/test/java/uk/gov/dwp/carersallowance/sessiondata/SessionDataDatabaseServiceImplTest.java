package uk.gov.dwp.carersallowance.sessiondata;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.Mock;
import org.mockito.Mockito;
import org.mockito.runners.MockitoJUnitRunner;
import org.springframework.http.*;
import org.springframework.web.client.RestTemplate;
import uk.gov.dwp.carersallowance.session.NoSessionException;
import uk.gov.dwp.carersallowance.utils.C3Constants;

import static org.junit.Assert.*;
import static org.mockito.Matchers.anyString;
import static org.mockito.Mockito.when;
import static org.hamcrest.CoreMatchers.is;


/**
 * Created by peterwhitehead on 30/12/2016.
 */
@RunWith(MockitoJUnitRunner.class)
public class SessionDataDatabaseServiceImplTest {
    private SessionDataDatabaseServiceImpl sessionDataDatabaseServiceImpl;

    @Mock
    private RestTemplate restTemplate;

    private final String sdURL = "http://localhost:9015";

    @Before
    public void setUp() throws Exception {
        sessionDataDatabaseServiceImpl = new SessionDataDatabaseServiceImpl(sdURL, "88a978e1-e927-4bb4-6722-18cdbc6d0516", 90, restTemplate);
    }

    @Test(expected = NoSessionException.class)
    public void testGetSessionDataNoData() throws Exception {
        final ResponseEntity<SessionData> response = new ResponseEntity(new SessionData(), HttpStatus.OK);
        when(restTemplate.exchange(anyString(), Mockito.<HttpMethod> any(), Mockito.<HttpEntity<String>> any(), Mockito.<Class<SessionData>> any())).thenReturn(response);
        sessionDataDatabaseServiceImpl.getSessionData("8a20d772-b998-486d-ba05-fd3ef75d4fd2");
    }

    @Test(expected = SessionTimeoutException.class)
    public void testGetSessionDataTimeout() throws Exception {
        final ResponseEntity<SessionData> response = new ResponseEntity(new SessionData(null, null, "91"), HttpStatus.OK);
        when(restTemplate.exchange(anyString(), Mockito.<HttpMethod> any(), Mockito.<HttpEntity<String>> any(), Mockito.<Class<SessionData>> any())).thenReturn(response);
        sessionDataDatabaseServiceImpl.getSessionData("8a20d772-b998-486d-ba05-fd3ef75d4fd2");
    }

    @Test
    public void testGetSessionData() throws Exception {
        final ResponseEntity<SessionData> response = new ResponseEntity(new SessionData("8a20d772-b998-486d-ba05-fd3ef75d4fd2", "PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxtYXA+PGVudHJ5PjxzdHJpbmc+Y2FyZXJTdXJuYW1lPC9zdHJpbmc+PHN0cmluZz5CbG9nZ3M8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmVkdWNhdGlvbkV4cGVjdGVkRW5kRGF0ZTwvc3RyaW5nPjxudWxsPjwvbnVsbD48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmFwcFZlcnNpb248L3N0cmluZz48c3RyaW5nPjAuMjc8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPm90aGVyU3RhdFBheW1lbnRIb3dPZnRlblBhaWRUaGlzUGF5PC9zdHJpbmc+PHN0cmluZz5Gb3VyLVdlZWtseTwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZW1wbG95ZXJBZGRyZXNzTGluZVR3bzwvc3RyaW5nPjxzdHJpbmc+TmV3dG93bjwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+cGFydG5lckRldGFpbHNTdXJuYW1lPC9zdHJpbmc+PHN0cmluZz5CbG9nZ3M8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPm90aGVyU3RhdFBheW1lbnRXaG9QYWlkWW91VGhpc1BheTwvc3RyaW5nPjxzdHJpbmc+SGlkaW5nIENvbnN1bHRhbnRzPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5wYWlkTW9uZXlEYXRlX2RheTwvc3RyaW5nPjxzdHJpbmc+MDg8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmNhcmVyRmlyc3ROYW1lPC9zdHJpbmc+PHN0cmluZz5Kb2U8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnN0YXJ0VGhpc1dvcmtfeWVhcjwvc3RyaW5nPjxzdHJpbmc+MjAxNTwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZmluaXNoVGhpc1dvcmtfZGF5PC9zdHJpbmc+PHN0cmluZz4wODwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+b3RoZXJTdGF0UGF5bWVudEFtb3VudE9mVGhpc1BheTwvc3RyaW5nPjxzdHJpbmc+MjIzLjU2PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5vdGhlclN0YXRQYXltZW50UGF5bWVudFR5cGVzRm9yVGhpc1BheTwvc3RyaW5nPjxzdHJpbmc+TWF0ZXJuaXR5T3JQYXRlcm5pdHlQYXk8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmV2aWRlbmNlQWRkcmVzc0xpbmVUaHJlZTwvc3RyaW5nPjxzdHJpbmc+V29sdmVyaGFtcHRvbjwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZW1wQWRkaXRpb25hbEluZm88L3N0cmluZz48c3RyaW5nPm5vPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5zaWNrUGF5SG93T2Z0ZW5QYWlkVGhpc1BheTwvc3RyaW5nPjxzdHJpbmc+V2Vla2x5PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5lbXBsb3ltZW50TGFzdFBhaWREYXRlX2RheTwvc3RyaW5nPjxzdHJpbmc+MDE8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmRhdGVPZkNsYWltPC9zdHJpbmc+PG51bGw+PC9udWxsPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZW1wbG95bWVudFNhbWVBbW91bnRFYWNoVGltZTwvc3RyaW5nPjxzdHJpbmc+eWVzPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5zZWxmRW1wbG95ZWRIYXZlRXhwZW5zZXNGb3JKb2I8L3N0cmluZz48c3RyaW5nPm5vPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5zcGVudDM1SG91cnNDYXJpbmc8L3N0cmluZz48c3RyaW5nPnllczwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZW1wbG95bWVudExhc3RQYWlkRGF0ZTwvc3RyaW5nPjxudWxsPjwvbnVsbD48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnN0YXJ0VGhpc1dvcmtfZGF5PC9zdHJpbmc+PHN0cmluZz4wODwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+cGFpZE1vbmV5RGF0ZV95ZWFyPC9zdHJpbmc+PHN0cmluZz4yMDE1PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5kaXJlY3RQYXltZW50U3RpbGxCZWluZ1BhaWRUaGlzUGF5PC9zdHJpbmc+PHN0cmluZz5ubzwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+Y2FyZXJDb250YWN0WW91QnlUZXh0UGhvbmU8L3N0cmluZz48c3RyaW5nPnllczwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+Y2FyZWVEYXRlT2ZCaXJ0aF95ZWFyPC9zdHJpbmc+PHN0cmluZz4yMDAxPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5lbXBsb3ltZW50TGFzdFBhaWREYXRlX21vbnRoPC9zdHJpbmc+PHN0cmluZz4wNDwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+dHJhbnNhY3Rpb25JZDwvc3RyaW5nPjxzdHJpbmc+MTYwODAwMDAzOTg8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmNhcmVyRGF0ZU9mQmlydGg8L3N0cmluZz48bnVsbD48L251bGw+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5iZWZvcmVDbGFpbUNhcmluZ0RhdGVfeWVhcjwvc3RyaW5nPjxzdHJpbmc+MjAxNjwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZW1wbG95bWVudExhc3RQYWlkRGF0ZV95ZWFyPC9zdHJpbmc+PHN0cmluZz4yMDE2PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5wYXlQZW5zaW9uU2NoZW1lPC9zdHJpbmc+PHN0cmluZz5ubzwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+bmF0aW9uYWxpdHk8L3N0cmluZz48c3RyaW5nPkJyaXRpc2g8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmFzc2lzdGVkRGVjaXNpb25SZWFzb248L3N0cmluZz48c3RyaW5nPlNlbmQgRFM3OTAvNzkwQiBDT01CIHRvIGN1c3RvbWVyLjwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZGlyZWN0UGF5bWVudFdoZW5EaWRZb3VMYXN0R2V0UGFpZDwvc3RyaW5nPjxudWxsPjwvbnVsbD48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmVtcGxveW1lbnRQaG9uZU51bWJlcjwvc3RyaW5nPjxzdHJpbmc+MDExMTExMTExMTE8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnRlbGxVc1doeUluZm9ybWF0aW9uPC9zdHJpbmc+PHN0cmluZz55ZXM8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmNhcmVlU2FtZUFkZHJlc3M8L3N0cmluZz48c3RyaW5nPm5vPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5wYXJ0bmVyRGV0YWlsc0ZpcnN0TmFtZTwvc3RyaW5nPjxzdHJpbmc+Sm9hbjwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+b3RoZXJQYXltZW50c0luZm88L3N0cmluZz48c3RyaW5nPlRlc3Rpbmcgb3RoZXIgcGF5bWVudHM8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmZpbmlzaFRoaXNXb3JrX3llYXI8L3N0cmluZz48c3RyaW5nPjIwMTY8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmZvc3RlcmluZ0FsbG93YW5jZVBheTwvc3RyaW5nPjxzdHJpbmc+Rm9zdGVyaW5nQWxsb3dhbmNlPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5vdGhlclN0YXRQYXltZW50V2hlbkRpZFlvdUxhc3RHZXRQYWlkX3llYXI8L3N0cmluZz48c3RyaW5nPjIwMTY8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmVlYUd1YXJkUXVlc3Rpb248L3N0cmluZz48c3RyaW5nPnllczwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZW1wbG95ZXJOYW1lPC9zdHJpbmc+PHN0cmluZz5IaWRpbmcgQ29uc3VsdGFudHM8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnBhcnRuZXJEZXRhaWxzRGF0ZU9mQmlydGhfZGF5PC9zdHJpbmc+PHN0cmluZz4wODwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+YmVmb3JlQ2xhaW1DYXJpbmc8L3N0cmluZz48c3RyaW5nPnllczwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+cGFpZE1vbmV5RGF0ZTwvc3RyaW5nPjxudWxsPjwvbnVsbD48L2VudHJ5PjxlbnRyeT48c3RyaW5nPm92ZXIzNUhvdXJzQVdlZWs8L3N0cmluZz48c3RyaW5nPnllczwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZGlyZWN0UGF5bWVudFdoZW5EaWRZb3VMYXN0R2V0UGFpZF95ZWFyPC9zdHJpbmc+PHN0cmluZz4yMDE2PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5lbXBsb3ltZW50UGF5bWVudEZyZXF1ZW5jeU90aGVyVGV4dDwvc3RyaW5nPjxzdHJpbmc+V2Vla2x5PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5ldmlkZW5jZUFkZHJlc3NMaW5lVHdvPC9zdHJpbmc+PHN0cmluZz5NYWlsIEhhbmRsaW5nIFNpdGUgQTwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+bW9yZUVtcGxveW1lbnQ8L3N0cmluZz48c3RyaW5nPm5vPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5jYXJlZUZpcnN0TmFtZTwvc3RyaW5nPjxzdHJpbmc+SmFuZTwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+aGF2ZUV4cGVuc2VzRm9ySm9iPC9zdHJpbmc+PHN0cmluZz5ubzwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+eW91ckluY29tZV9zaWNrcGF5PC9zdHJpbmc+PHN0cmluZz55ZXM8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmVtcGxveW1lbnRQYXlJbmNsdXNpb25zPC9zdHJpbmc+PHN0cmluZz5Tb21lIGNhdG5pcCBvbiB0aGUgc2lkZTwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+Y2FyZXJOYXRpb25hbEluc3VyYW5jZU51bWJlcjwvc3RyaW5nPjxzdHJpbmc+QUIxMjM0NTZEPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5ldmlkZW5jZUFkZHJlc3NMaW5lT25lPC9zdHJpbmc+PHN0cmluZz5DYXJlcidzIEFsbG93YW5jZSBVbml0PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5kaXJlY3RQYXltZW50V2hlbkRpZFlvdUxhc3RHZXRQYWlkX2RheTwvc3RyaW5nPjxzdHJpbmc+MDg8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmRhdGVPZkNsYWltX21vbnRoPC9zdHJpbmc+PHN0cmluZz4wNDwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZW1wbG95ZXJBZGRyZXNzTGluZU9uZTwvc3RyaW5nPjxzdHJpbmc+NDU2IFN0cmVldDwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+Y2FyZXJQb3N0Y29kZTwvc3RyaW5nPjxzdHJpbmc+QzRUIDBBRDwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZW1wbG95bWVudEdyb3NzUGF5PC9zdHJpbmc+PHN0cmluZz4zMDAwPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5vdGhlclN0YXRQYXltZW50U3RpbGxCZWluZ1BhaWRUaGlzUGF5PC9zdHJpbmc+PHN0cmluZz5ubzwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+Y2FyZXJBZGRyZXNzTGluZVR3bzwvc3RyaW5nPjxzdHJpbmc+U3RyZWV0PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5iZWZvcmVDbGFpbUNhcmluZ0RhdGVfZGF5PC9zdHJpbmc+PHN0cmluZz4wODwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+YmVlblNlbGZFbXBsb3llZFNpbmNlMVdlZWtCZWZvcmVDbGFpbTwvc3RyaW5nPjxzdHJpbmc+eWVzPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5jYXJlZVN1cm5hbWU8L3N0cmluZz48c3RyaW5nPkJsb2dnczwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+YW55dGhpbmdFbHNlPC9zdHJpbmc+PHN0cmluZz5ubzwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+Y2FyZXJBZGRyZXNzTGluZU9uZTwvc3RyaW5nPjxzdHJpbmc+MTIzPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5jYXJlckRhdGVPZkJpcnRoX3llYXI8L3N0cmluZz48c3RyaW5nPjE5OTA8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmVtcGxveW1lbnR3aGVuR2V0UGFpZDwvc3RyaW5nPjxzdHJpbmc+RnJpZGF5czwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+bGlrZVRvUGF5PC9zdHJpbmc+PHN0cmluZz5ubzwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZmluaXNoZWRUaGlzSm9iPC9zdHJpbmc+PHN0cmluZz5ubzwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZGF0ZVRpbWVHZW5lcmF0ZWQ8L3N0cmluZz48c3RyaW5nPjEyLTA4LTIwMTYgMTU6MzU8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnlvdXJJbmNvbWVfYW55b3RoZXI8L3N0cmluZz48c3RyaW5nPnllczwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+eG1sVmVyc2lvbjwvc3RyaW5nPjxzdHJpbmc+My4xNTwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+dHJpcDUyV2Vla3M8L3N0cmluZz48c3RyaW5nPm5vPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5zdGFydFRoaXNXb3JrX21vbnRoPC9zdHJpbmc+PHN0cmluZz4xMDwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+YXNzaXN0ZWREZWNpc2lvbkRlY2lzaW9uPC9zdHJpbmc+PHN0cmluZz5ub25lLHNob3cgdGFibGU8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmVkdWNhdGlvblN0YXJ0RGF0ZV9tb250aDwvc3RyaW5nPjxzdHJpbmc+MDM8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmVkdWNhdGlvblN0YXJ0RGF0ZTwvc3RyaW5nPjxudWxsPjwvbnVsbD48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmZvc3RlcmluZ0FsbG93YW5jZVN0aWxsQmVpbmdQYWlkVGhpc1BheTwvc3RyaW5nPjxzdHJpbmc+eWVzPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5zdGFydEpvYkJlZm9yZUNsYWltRGF0ZTwvc3RyaW5nPjxzdHJpbmc+eWVzPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5uYW1lT2ZTY2hvb2xDb2xsZWdlT3JVbml2ZXJzaXR5PC9zdHJpbmc+PHN0cmluZz5BIENvbGxlZ2U8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmZvc3RlcmluZ0FsbG93YW5jZUFtb3VudE9mVGhpc1BheTwvc3RyaW5nPjxzdHJpbmc+MzIzLjU2PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5zaWNrUGF5V2hlbkRpZFlvdUxhc3RHZXRQYWlkPC9zdHJpbmc+PG51bGw+PC9udWxsPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+bGFuZ3VhZ2U8L3N0cmluZz48c3RyaW5nPkVuZ2xpc2g8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnBheW1lbnRGcmVxdWVuY3k8L3N0cmluZz48c3RyaW5nPkV2ZXJ5IHdlZWs8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPm90aGVyU3RhdFBheW1lbnRXaGVuRGlkWW91TGFzdEdldFBhaWRfZGF5PC9zdHJpbmc+PHN0cmluZz4wODwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+YWx3YXlzTGl2ZWRJblVLPC9zdHJpbmc+PHN0cmluZz55ZXM8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmNvdXJzZVRpdGxlPC9zdHJpbmc+PHN0cmluZz5CaW9sb2d5PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz50aGlyZFBhcnR5PC9zdHJpbmc+PHN0cmluZz55ZXM8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnBheUZvclRoaW5nczwvc3RyaW5nPjxzdHJpbmc+bm88L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnBhcnRuZXJEZXRhaWxzRGF0ZU9mQmlydGhfbW9udGg8L3N0cmluZz48c3RyaW5nPjA0PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz53ZWxzaENvbW11bmljYXRpb248L3N0cmluZz48c3RyaW5nPm5vPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5vdmVyMTZZZWFyc09sZDwvc3RyaW5nPjxzdHJpbmc+eWVzPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5wYWlkTW9uZXk8L3N0cmluZz48c3RyaW5nPnllczwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZWR1Y2F0aW9uRXhwZWN0ZWRFbmREYXRlX3llYXI8L3N0cmluZz48c3RyaW5nPjIwMTg8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPm1vcmVUaGFuWWVhckFnbzwvc3RyaW5nPjxzdHJpbmc+bm88L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmV2aWRlbmNlUG9zdGNvZGU8L3N0cmluZz48c3RyaW5nPldWOTggMkFCPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5jYXJlZUFkZHJlc3NMaW5lT25lPC9zdHJpbmc+PHN0cmluZz40NzAgU3RyZWV0PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5wYWlkTW9uZXlEYXRlX21vbnRoPC9zdHJpbmc+PHN0cmluZz4xMTwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+Y2FyZXJNYWlsQ29uZmlybWF0aW9uPC9zdHJpbmc+PHN0cmluZz5jYWRzLmR3cEBnbWFpbC5jb208L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmlzUGFydG5lclBlcnNvbllvdUNhcmVGb3I8L3N0cmluZz48c3RyaW5nPm5vPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5kaXJlY3RQYXltZW50V2hvUGFpZFlvdVRoaXNQYXk8L3N0cmluZz48c3RyaW5nPkhpZGluZyBDb25zdWx0YW50czwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZmluaXNoVGhpc1dvcms8L3N0cmluZz48bnVsbD48L251bGw+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5jYXJlclRpdGxlPC9zdHJpbmc+PHN0cmluZz5Ncjwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZWR1Y2F0aW9uRXhwZWN0ZWRFbmREYXRlX21vbnRoPC9zdHJpbmc+PHN0cmluZz4wNDwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+c3RhcnRUaGlzV29yazwvc3RyaW5nPjxudWxsPjwvbnVsbD48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmJlZm9yZUNsYWltQ2FyaW5nRGF0ZV9tb250aDwvc3RyaW5nPjxzdHJpbmc+MDE8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnBhcnRuZXJEZXRhaWxzRGF0ZU9mQmlydGg8L3N0cmluZz48bnVsbD48L251bGw+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5kaXJlY3RQYXltZW50V2hlbkRpZFlvdUxhc3RHZXRQYWlkX21vbnRoPC9zdHJpbmc+PHN0cmluZz4wMTwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZGlyZWN0UGF5bWVudEhvd09mdGVuUGFpZFRoaXNQYXlPdGhlcjwvc3RyaW5nPjxzdHJpbmc+VHdpY2UgYSBkYXk8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnBhcnRuZXJEZXRhaWxzRGF0ZU9mQmlydGhfeWVhcjwvc3RyaW5nPjxzdHJpbmc+MjAwNjwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+Y2FyZXJEYXRlT2ZCaXJ0aF9kYXk8L3N0cmluZz48c3RyaW5nPjEwPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5wYXJ0bmVyRGV0YWlsc1NlcGFyYXRlZDwvc3RyaW5nPjxzdHJpbmc+bm88L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmJlZW5JbkVkdWNhdGlvblNpbmNlQ2xhaW1EYXRlPC9zdHJpbmc+PHN0cmluZz55ZXM8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnN0aWxsU2VsZkVtcGxveWVkPC9zdHJpbmc+PHN0cmluZz5ubzwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+d29ya2luZ0ZvckVFQURldGFpbHM8L3N0cmluZz48c3RyaW5nPm5vPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5iZWVuRW1wbG95ZWRTaW5jZTZNb250aHNCZWZvcmVDbGFpbTwvc3RyaW5nPjxzdHJpbmc+eWVzPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5lZHVjYXRpb25TdGFydERhdGVfZGF5PC9zdHJpbmc+PHN0cmluZz4wODwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+eW91ckluY29tZV9wYXRtYXRhZG9wcGF5PC9zdHJpbmc+PHN0cmluZz55ZXM8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnNpY2tQYXlXaGVuRGlkWW91TGFzdEdldFBhaWRfbW9udGg8L3N0cmluZz48c3RyaW5nPjAxPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5iZW5lZml0c0Fuc3dlcjwvc3RyaW5nPjxzdHJpbmc+QUE8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnNlbGZFbXBsb3llZFBheVBlbnNpb25TY2hlbWU8L3N0cmluZz48c3RyaW5nPm5vPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5tYXJpdGFsU3RhdHVzPC9zdHJpbmc+PHN0cmluZz5TaW5nbGU8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnlvdXJJbmNvbWVfZGlyZWN0cGF5PC9zdHJpbmc+PHN0cmluZz55ZXM8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmJlZm9yZUNsYWltQ2FyaW5nRGF0ZTwvc3RyaW5nPjxudWxsPjwvbnVsbD48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmNhcmVlUmVsYXRpb25zaGlwPC9zdHJpbmc+PHN0cmluZz5HcmFuZG1hPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5zaWNrUGF5V2hlbkRpZFlvdUxhc3RHZXRQYWlkX3llYXI8L3N0cmluZz48c3RyaW5nPjIwMTY8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnNpY2tQYXlTdGlsbEJlaW5nUGFpZFRoaXNQYXk8L3N0cmluZz48c3RyaW5nPm5vPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5zaWNrUGF5V2hlbkRpZFlvdUxhc3RHZXRQYWlkX2RheTwvc3RyaW5nPjxzdHJpbmc+MDg8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmNhcmVyV2FudHNFbWFpbENvbnRhY3Q8L3N0cmluZz48c3RyaW5nPnllczwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+cGFydG5lckRldGFpbHNUaXRsZTwvc3RyaW5nPjxzdHJpbmc+TWlzczwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+aGFkT3RoZXJJbmNvbWVTaW5jZUNsYWltRGF0ZTwvc3RyaW5nPjxzdHJpbmc+U29tZTwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+YmVuZWZpdHNGcm9tRUVBRGV0YWlsczwvc3RyaW5nPjxzdHJpbmc+bm88L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPm9yaWdpbjwvc3RyaW5nPjxzdHJpbmc+R0I8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnNpY2tQYXlXaG9QYWlkWW91VGhpc1BheTwvc3RyaW5nPjxzdHJpbmc+SGlkaW5nIENvbnN1bHRhbnRzPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5lZHVjYXRpb25FeHBlY3RlZEVuZERhdGVfZGF5PC9zdHJpbmc+PHN0cmluZz4wODwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZWR1Y2F0aW9uU3RhcnREYXRlX3llYXI8L3N0cmluZz48c3RyaW5nPjIwMTY8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmNhcmVyTWFpbDwvc3RyaW5nPjxzdHJpbmc+Y2Fkcy5kd3BAZ21haWwuY29tPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5jYXJlZURhdGVPZkJpcnRoX2RheTwvc3RyaW5nPjxzdHJpbmc+MDg8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmhhZFBhcnRuZXJTaW5jZUNsYWltRGF0ZTwvc3RyaW5nPjxzdHJpbmc+eWVzPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5kaXJlY3RQYXltZW50SG93T2Z0ZW5QYWlkVGhpc1BheTwvc3RyaW5nPjxzdHJpbmc+T3RoZXI8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPnBhcnRuZXJEZXRhaWxzTmF0aW9uYWxpdHk8L3N0cmluZz48c3RyaW5nPkJyaXRpc2g8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmNhcmVlVGl0bGU8L3N0cmluZz48c3RyaW5nPk1yczwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+bmFtZU9mTWFpblRlYWNoZXJPclR1dG9yPC9zdHJpbmc+PHN0cmluZz5BIFR1dG9yPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz55b3VySW5jb21lX2Zvc3RlcmluZzwvc3RyaW5nPjxzdHJpbmc+eWVzPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5uYW1lQW5kT3JnYW5pc2F0aW9uPC9zdHJpbmc+PHN0cmluZz5KZW5ueSBCbG9nZ3MgUHJlc3RvbiBjYXJlcnM8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmZpbmlzaFRoaXNXb3JrX21vbnRoPC9zdHJpbmc+PHN0cmluZz4wMjwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+Y2FyZWVQb3N0Y29kZTwvc3RyaW5nPjxzdHJpbmc+UFIxIDFIQjwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+ZGF0ZU9mQ2xhaW1feWVhcjwvc3RyaW5nPjxzdHJpbmc+MjAxNjwvc3RyaW5nPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+b3RoZXJTdGF0UGF5bWVudFdoZW5EaWRZb3VMYXN0R2V0UGFpZF9tb250aDwvc3RyaW5nPjxzdHJpbmc+MDE8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmNhcmVlQWRkcmVzc0xpbmVUd288L3N0cmluZz48c3RyaW5nPk5ld3Rvd248L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmNhcmVlRGF0ZU9mQmlydGg8L3N0cmluZz48bnVsbD48L251bGw+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5zaWNrUGF5QW1vdW50T2ZUaGlzUGF5PC9zdHJpbmc+PHN0cmluZz4xMjMuNTY8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmZvc3RlcmluZ0FsbG93YW5jZVdob1BhaWRZb3VUaGlzUGF5PC9zdHJpbmc+PHN0cmluZz5IaWRpbmcgQ29uc3VsdGFudHM8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPm9yaWdpbkNvdW50cnk8L3N0cmluZz48c3RyaW5nPkdCPC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5mb3N0ZXJpbmdBbGxvd2FuY2VIb3dPZnRlblBhaWRUaGlzUGF5PC9zdHJpbmc+PHN0cmluZz5Nb250aGx5PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5kaXJlY3RQYXltZW50QW1vdW50T2ZUaGlzUGF5PC9zdHJpbmc+PHN0cmluZz40MjMuNTY8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmRhdGVPZkNsYWltX2RheTwvc3RyaW5nPjxzdHJpbmc+MDg8L3N0cmluZz48L2VudHJ5PjxlbnRyeT48c3RyaW5nPmNhcmVlRGF0ZU9mQmlydGhfbW9udGg8L3N0cmluZz48c3RyaW5nPjA0PC9zdHJpbmc+PC9lbnRyeT48ZW50cnk+PHN0cmluZz5vdGhlclN0YXRQYXltZW50V2hlbkRpZFlvdUxhc3RHZXRQYWlkPC9zdHJpbmc+PG51bGw+PC9udWxsPjwvZW50cnk+PGVudHJ5PjxzdHJpbmc+Y2FyZXJEYXRlT2ZCaXJ0aF9tb250aDwvc3RyaW5nPjxzdHJpbmc+MTA8L3N0cmluZz48L2VudHJ5PjwvbWFwPg==", "89"), HttpStatus.OK);
        when(restTemplate.exchange(anyString(), Mockito.<HttpMethod> any(), Mockito.<HttpEntity<String>> any(), Mockito.<Class<SessionData>> any())).thenReturn(response);
        final Session session = sessionDataDatabaseServiceImpl.getSessionData("8a20d772-b998-486d-ba05-fd3ef75d4fd2");
        assertThat(session.getAttribute("carerSurname"), is("Bloggs"));
    }

    @Test
    public void testCreateSessionData() throws Exception {
        final ResponseEntity<String> response = new ResponseEntity("", HttpStatus.OK);
        when(restTemplate.exchange(anyString(), Mockito.<HttpMethod> any(), Mockito.<HttpEntity<String>> any(), Mockito.<Class<String>> any())).thenReturn(response);
        Session session = sessionDataDatabaseServiceImpl.createSessionData("8a20d772-b998-486d-ba05-fd3ef75d4fd2", C3Constants.CLAIM);
        assertThat(session.getSessionId(), is("8a20d772-b998-486d-ba05-fd3ef75d4fd2"));
    }

    @Test
    public void testSaveSessionData() throws Exception {
        final ResponseEntity<String> response = new ResponseEntity("", HttpStatus.OK);
        final Session session = new Session("8a20d772-b998-486d-ba05-fd3ef75d4fd2");
        when(restTemplate.exchange(anyString(), Mockito.<HttpMethod> any(), Mockito.<HttpEntity<String>> any(), Mockito.<Class<String>> any())).thenReturn(response);
        final Session session1 = sessionDataDatabaseServiceImpl.saveSessionData(session);
        assertThat(session1.getSessionId(), is("8a20d772-b998-486d-ba05-fd3ef75d4fd2"));
    }

    @Test
    public void testRemoveSessionData() throws Exception {
        final ResponseEntity<String> response = new ResponseEntity("", HttpStatus.OK);
        when(restTemplate.exchange(anyString(), Mockito.<HttpMethod> any(), Mockito.<HttpEntity<String>> any(), Mockito.<Class<String>> any())).thenReturn(response);
        sessionDataDatabaseServiceImpl.removeSessionData("8a20d772-b998-486d-ba05-fd3ef75d4fd2");
    }
}